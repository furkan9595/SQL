CREATE VIEW AS 
 SELECT   DATEPART(YEAR,CU.DATEE) YIL , 
 CASE 
	WHEN DATEPART(MONTH,CU.DATEE)=1 THEN 'OCAK'
	WHEN DATEPART(MONTH,CU.DATEE)=2 THEN 'ŞUBAT'
	WHEN DATEPART(MONTH,CU.DATEE)=3 THEN 'MART'
	WHEN DATEPART(MONTH,CU.DATEE)=4 THEN 'NİSAN'
	WHEN DATEPART(MONTH,CU.DATEE)=5 THEN 'MAYIS'
	WHEN DATEPART(MONTH,CU.DATEE)=6 THEN 'HAZİRAN'
    WHEN DATEPART(MONTH,CU.DATEE)=7 THEN 'TEMMUZ'
    WHEN DATEPART(MONTH,CU.DATEE)=8 THEN 'AĞUSTOS'
	WHEN DATEPART(MONTH,CU.DATEE)=9 THEN 'EYLÜL'
	WHEN DATEPART(MONTH,CU.DATEE)=10 THEN 'EKİM'
	WHEN DATEPART(MONTH,CU.DATEE)=11 THEN 'KASIM'
	WHEN DATEPART(MONTH,CU.DATEE)=12 THEN 'ARALIK'
END AS AY,
 SUM(SU.Price) TOPLAMMİKTAR,SUM(SU.Quantity)URUN_SAYISI,SUM(SU.Profit) TOPLAMKÂR 
 FROM CustomerName CU INNER JOIN SuperStore
 SU ON SU.Order_Id=CU.Id  
GROUP BY DATEPART(YEAR,CU.DATEE),DATEPART(MONTH,CU.DATEE)
ORDER BY DATEPART(YEAR,CU.DATEE)


 
